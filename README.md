# Опис основних сутностей
___
## Обрані сутності
Сутності, які було обрано для даного завдання, що відносяться як "багато-до-одного":
> Пісня - Виконавець
## Song Має такі поля:
- id - Унікальний ідентифікатор пісні;
- title - Назва пісні;
- album - Альбом, в якому знаходиться пісня;
- year - Рік випуску пісні;
- genres - Жанри пісні
## Artist має такі поля:
- id - Унікальний ідентифікатор виконавця;
- fullName - Повне ім'я виконавця або назва гурту;
- bio - Опис виконавця або гурту;
___

# Опис endpoint'ів:
## Для Song:
- ```POST /api/songs``` - Створює новий запис Song.  
Приймає JSON з полями:
  - title
  - album
  - year
  - genres
  - artistId
- ```GET /api/songs/{id}``` - Повертає детальні дані запису Song, включаючи дані Artist, на якого вона посилається.  
Приймає параметр id пісні.
- ```PUT /api/songs/{id}``` - Оновлює дані одного запису Song по ID.  
Приймає параметр id пісні і JSON з полями:
  - title
  - album
  - year
  - genres
  - artistId
- ```DELETE /api/songs/{id}``` - Видаляє запис Song по ID.  
Приймає параметр id пісні.
- ```POST /api/songs/_list``` - Повертає структуру даних, яка має список елементів Song, які відповідають
запитаній сторінці, а також загальну кількість сторінок.  
Приймає JSON з полями
  - songId
  - title
  - album
  - year
  - page
  - size
- ```POST /api/songs/_report``` - Генерує файл-репорт у вигляді Excel-таблиць з усіма записами, які відповідають
критеріям фільтрації.  
Приймає JSON з полями:
  - songId
  - title
  - album
  - year
  - page
  - size
- ```POST /api/entity1/upload``` - Зберігає в БД всі валідні записи з файлу. У відповідь генерує JSON, в якому
зазначає кількість успішно та неуспішно імпортованих записів.  
Приймає JSON-файл із записами, що повинні містити такі поля:  
```json
{
    "title" : "",
    "album" : "",
    "year" : 2000,
    "genres" : "",
    "artistId" : 111
  }
```
## Для Artist:
- ```GET /api/artists``` - Повертає список всіх наявних в БД записів Artist.  
Не приймає додаткових параметрів.
- ```POST /api/artists``` - Додає унікальні (за fullName) записи Artist.  
Приймає JSON з такими полями:
  - fullName
  - bio
- ```PUT /api/artists/{id}``` - Змінює запис Artist по ID, враховуючи контроль унікальності (за fullName) найменувань Artist.  
Приймає параметр id виконавця і JSON з такими полями:
  - fullName
  - bio
- ```DELETE /api/artists/{id}``` - Видаляє запис Artist по ID.  
Приймає параметр id виконавця.
___

# База даних PostgreSQL

База даних PostgreSQL розгортаєтсья у docker-контейнері.  
Щоб розгорнути базу на локальній машині потрібно:
- Знаходячись у кореневій папці, відкрити термінал.
- Перейти за шляхом ```cd docker```.
- Виконати команду ```docker-compose up```.
___

# Liquibase script:
### Міграція initialize-db.xml:
Створює таблиці artists та songs, додає constraints до цих таблиць для сутностей Artist та Song відповідно.
### Міграція create-indexes.xml:
Створює індекси до полів Song, які використовуватимуться найчастіше в пошуку записів у базі даних.
### Міграція fill-artist-table.xml:
Заповнює таблицю artists десятьма записами сутності Artist.
### Міграція main-changelog.xml:
Об'єднує і запускає всі вищеперераховані міграції.
___

# Файл для імпорту даних
JSON-файл із 54 записами сутності Song знаходиться за шляхом ```/resources/in.json```. Ці сутності узгоджені з liquibase
скриптом наповнення, адже використовують id створених виконавців.
___